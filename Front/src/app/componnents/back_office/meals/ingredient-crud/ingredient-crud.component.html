<!-- partial:index.partial.html -->
<div class="dashboard">
  <div class="ui-row-1">
    <div class="logo-comp">
        <p style="color: black;">WELL <a style="color: orange;">U</a></p>
    </div>
    <div class="search">
        <input type="search" id="search" name="search" placeholder="Search...">
        <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
            <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z" />
        </svg>
    </div>
    <div class="profile">
        <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-bell-fill" viewBox="0 0 16 16">
            <path d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2zm.995-14.901a1 1 0 1 0-1.99 0A5.002 5.002 0 0 0 3 6c0 1.098-.5 6-2 7h14c-1.5-1-2-5.902-2-7 0-2.42-1.72-4.44-4.005-4.901z" />
        </svg>
        <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-gear-fill" viewBox="0 0 16 16">
            <path d="M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311c.446.82.023 1.841-.872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1 .872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413 1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872l-.1-.34zM8 10.93a2.929 2.929 0 1 1 0-5.86 2.929 2.929 0 0 1 0 5.858z" />
        </svg>
        <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-caret-down-fill" viewBox="0 0 16 16">
            <path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z" />
        </svg>
    </div>
    <div class="d-flex">
      <!-- If not logged in -->
      <button class="btn-login" type="button" *ngIf="!isLoggedIn" routerLink="/login">Login</button>
      <button class="btn-register" type="button" *ngIf="!isLoggedIn" routerLink="/register">Register</button>

      <!-- If logged in -->
      <div *ngIf="isLoggedIn" class="d-flex align-items-center position-relative">
        <!-- Profile Photo -->
        <img
          [src]="userPhotoUrl ? userPhotoUrl : 'assets/static_assets/user.png'"
          alt="User Photo"
          class="rounded-circle me-2"
          width="40"
          height="40"
          (click)="toggleDropdown()"
          style="cursor: pointer;">

        <!-- Dropdown -->
        <div *ngIf="isDropdownOpen"
             class="position-absolute bg-white shadow rounded p-3"
             style="top: 50px; right: 0; min-width: 200px; z-index: 1000;">

          <!-- User Info -->
          <div class="mb-2">
            <span class="fw-bold d-block">{{ username }}</span>
            <span class="text-muted small">{{ role }}</span>
          </div>

          <hr class="my-2">
          <a class="dropdown-item text-start w-100 btn btn-sm mb-1"
             routerLink="['/profile', '@' + username]">

          Profile
          </a>
          <!-- Edit Profile -->
          <a class="dropdown-item text-start w-100 btn btn-sm mb-1"
             routerLink="/profile-update">
            Edit Profile
          </a>

          <!-- Logout -->
          <button class="dropdown-item text-start w-100 btn btn-sm btn-outline-danger"
                  (click)="logout()">
            Logout
          </button>
        </div>
      </div>
    </div>
      
    
</div>

          <div class="ui-row-2">
            <div class="left-sidebar">
  
              <div>
                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="m8 3.293 6 6V13.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5V9.293l6-6zm5-.793V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z" />
                  <path fill-rule="evenodd" d="M7.293 1.5a1 1 0 0 1 1.414 0l6.647 6.646a.5.5 0 0 1-.708.708L8 2.207 1.354 8.854a.5.5 0 1 1-.708-.708L7.293 1.5z" />
                </svg>
              </div>
    
              <div>
                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-star-fill" viewBox="0 0 16 16">
                  <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z" />
                </svg>
              </div>
    
              <div>
                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-bookmarks-fill" viewBox="0 0 16 16">
                  <path d="M2 4a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v11.5a.5.5 0 0 1-.777.416L7 13.101l-4.223 2.815A.5.5 0 0 1 2 15.5V4z" />
                  <path d="M4.268 1A2 2 0 0 1 6 0h6a2 2 0 0 1 2 2v11.5a.5.5 0 0 1-.777.416L13 13.768V2a1 1 0 0 0-1-1H4.268z" />
                </svg>
              </div>
    
              <div>
                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-bar-chart-fill" viewBox="0 0 16 16">
                  <path d="M1 11a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1v-3zm5-4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7zm5-5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1V2z" />
                </svg>
              </div>
    
              <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-people-fill" viewBox="0 0 16 16">
                  <path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" />
                  <path fill-rule="evenodd" d="M5.216 14A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1h4.216z" />
                  <path d="M4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z" />
                </svg>
              </div>
    
              <div>
                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-tags-fill" viewBox="0 0 16 16">
                  <path d="M2 2a1 1 0 0 1 1-1h4.586a1 1 0 0 1 .707.293l7 7a1 1 0 0 1 0 1.414l-4.586 4.586a1 1 0 0 1-1.414 0l-7-7A1 1 0 0 1 2 6.586V2zm3.5 4a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z" />
                  <path d="M1.293 7.793A1 1 0 0 1 1 7.086V2a1 1 0 0 0-1 1v4.586a1 1 0 0 0 .293.707l7 7a1 1 0 0 0 1.414 0l.043-.043-7.457-7.457z" />
                </svg>
              </div>
    
            </div>

            <div class="container">
              <h2>Ingredient Management</h2>
            
              <!-- Search Bar -->
              <div class="search-bar">
                <input
                  type="text"
                  [(ngModel)]="searchText"
                  (input)="searchIngredients()"
                  placeholder="Search for an ingredient..."
                  #searchTextInput="ngModel"
                  minlength="2"
                  maxlength="50"
                  pattern="^[A-Za-zÀ-ÖØ-öø-ÿ\s]+$"
                  required
                />
                <div *ngIf="searchTextInput.invalid && searchTextInput.touched" class="error">
                  Invalid input. Only letters and spaces allowed.
                </div>
              </div>
            
              <!-- Ingredient List - This will only show when showList is true -->
              <div *ngIf="showList" class="ingredient-list">
                <ul>
                  <li *ngFor="let ingredient of ingredients" (click)="selectIngredient(ingredient)" class="ingredient-item">
                    <div class="ingredient-name">{{ ingredient.food }}</div>
                    <div class="ingredient-category">{{ ingredient.category }}</div>
                  </li>
                </ul>
                <button (click)="showAddIngredientForm()" class="add-btn">Add</button>
              </div>
            
              <!-- Ingredient Details - This will show when an ingredient is selected -->
              <div *ngIf="!showList && searchedIngredient" class="ingredient-details">
                <button class="back-btn" (click)="goBackToList()">Back to List</button>
                <h3>Ingredient Details</h3>
                <form (submit)="updateIngredient()">
                  <div class="form-group">
                    <label>Food:</label>
                    <input [(ngModel)]="searchedIngredient.food" name="food" #foodInput="ngModel" required pattern="^[A-Za-zÀ-ÖØ-öø-ÿ\s]+$" minlength="2" maxlength="50" />
                    <div *ngIf="foodInput.invalid && foodInput.touched" class="error">
                      Food name must be between 2 and 50 letters.
                    </div>
                  </div>
                  <div class="form-group">
                    <label>Measure:</label>
                    <input [(ngModel)]="searchedIngredient.measure" name="measure" #measureInput="ngModel" required minlength="1" maxlength="30" />
                    <div *ngIf="measureInput.invalid && measureInput.touched" class="error">
                      Measure is required.
                    </div>
                  </div>
                  <div class="form-group">
                    <label>Grams:</label>
                    <input type="number" [(ngModel)]="searchedIngredient.grams" name="grams" #gramsInput="ngModel" required min="0" />
                    <div *ngIf="gramsInput.invalid && gramsInput.touched" class="error">
                      Grams must be a positive number.
                    </div>
                  </div>
                  <div class="form-group">
                    <label>Calories:</label>
                    <input type="number" [(ngModel)]="searchedIngredient.calories" name="calories" #caloriesInput="ngModel" required min="0" />
                    <div *ngIf="caloriesInput.invalid && caloriesInput.touched" class="error">
                      Calories must be a positive number.
                    </div>
                  </div>
                  <div class="form-group">
                    <label>Protein:</label>
                    <input type="number" [(ngModel)]="searchedIngredient.protein" name="protein" #proteinInput="ngModel" required min="0" />
                    <div *ngIf="proteinInput.invalid && proteinInput.touched" class="error">
                      Protein must be a positive number.
                    </div>
                  </div>
                  <div class="form-group">
                    <label>Carbs:</label>
                    <input type="number" [(ngModel)]="searchedIngredient.carbs" name="carbs" #carbsInput="ngModel" required min="0" />
                    <div *ngIf="carbsInput.invalid && carbsInput.touched" class="error">
                      Carbs must be a positive number.
                    </div>
                  </div>
                  <div class="form-group">
                    <label>Fat:</label>
                    <input type="number" [(ngModel)]="searchedIngredient.fat" name="fat" #fatInput="ngModel" required min="0" />
                    <div *ngIf="fatInput.invalid && fatInput.touched" class="error">
                      Fat must be a positive number.
                    </div>
                  </div>
                  <div class="form-group">
                    <label>Sat Fat:</label>
                    <input type="number" [(ngModel)]="searchedIngredient.satFat" name="satFat" #satFatInput="ngModel" required min="0" />
                    <div *ngIf="satFatInput.invalid && satFatInput.touched" class="error">
                      Saturated fat must be a positive number.
                    </div>
                  </div>
                  <div class="form-group">
                    <label>Fiber:</label>
                    <input type="number" [(ngModel)]="searchedIngredient.fiber" name="fiber" #fiberInput="ngModel" required min="0" />
                    <div *ngIf="fiberInput.invalid && fiberInput.touched" class="error">
                      Fiber must be a positive number.
                    </div>
                  </div>
                  <div class="form-group">
                    <label>Category:</label>
                    <select [(ngModel)]="searchedIngredient.category" name="category" required>
                      <option *ngFor="let category of categories" [value]="category">{{ category }}</option>
                    </select>
                  </div>
                  <div class="form-actions">
                    <button type="submit" class="update-btn" [disabled]="foodInput.invalid || gramsInput.invalid || caloriesInput.invalid">Update</button>
                    <button type="button" class="delete-btn" (click)="deleteIngredient()">Delete</button>
                  </div>
                </form>
              </div>
            
              <!-- Add New Ingredient Form - Show this form when showAddForm is true -->
              <div *ngIf="showAddForm" class="add-ingredient-form">
                <button (click)="hideAddIngredientForm()" class="close-btn">Close</button>
                <h3>Add New Ingredient</h3>
                <form (submit)="addIngredient()">
                  <div class="form-group">
                    <label>Food:</label>
                    <input [(ngModel)]="newIngredient.food" name="food" #foodInput="ngModel" required pattern="^[A-Za-zÀ-ÖØ-öø-ÿ\s]+$" minlength="2" maxlength="50" />
                    <div *ngIf="foodInput.invalid && foodInput.touched" class="error">
                      Food name must be between 2 and 50 letters.
                    </div>
                  </div>
                  <div class="form-group">
                    <label>Measure:</label>
                    <input [(ngModel)]="newIngredient.measure" name="measure" #measureInput="ngModel" required minlength="1" maxlength="30" />
                    <div *ngIf="measureInput.invalid && measureInput.touched" class="error">
                      Measure is required.
                    </div>
                  </div>
                  <div class="form-group">
                    <label>Grams:</label>
                    <input type="number" [(ngModel)]="newIngredient.grams" name="grams" #gramsInput="ngModel" required min="0" />
                    <div *ngIf="gramsInput.invalid && gramsInput.touched" class="error">
                      Grams must be a positive number.
                    </div>
                  </div>
                  <div class="form-group">
                    <label>Calories:</label>
                    <input type="number" [(ngModel)]="newIngredient.calories" name="calories" #caloriesInput="ngModel" required min="0" />
                    <div *ngIf="caloriesInput.invalid && caloriesInput.touched" class="error">
                      Calories must be a positive number.
                    </div>
                  </div>
                  <div class="form-group">
                    <label>Protein:</label>
                    <input type="number" [(ngModel)]="newIngredient.protein" name="protein" #proteinInput="ngModel" required min="0" />
                    <div *ngIf="proteinInput.invalid && proteinInput.touched" class="error">
                      Protein must be a positive number.
                    </div>
                  </div>
                  <div class="form-group">
                    <label>Carbs:</label>
                    <input type="number" [(ngModel)]="newIngredient.carbs" name="carbs" #carbsInput="ngModel" required min="0" />
                    <div *ngIf="carbsInput.invalid && carbsInput.touched" class="error">
                      Carbs must be a positive number.
                    </div>
                  </div>
                  <div class="form-group">
                    <label>Fat:</label>
                    <input type="number" [(ngModel)]="newIngredient.fat" name="fat" #fatInput="ngModel" required min="0" />
                    <div *ngIf="fatInput.invalid && fatInput.touched" class="error">
                      Fat must be a positive number.
                    </div>
                  </div>
                  <div class="form-group">
                    <label>Sat Fat:</label>
                    <input type="number" [(ngModel)]="newIngredient.satFat" name="satFat" #satFatInput="ngModel" required min="0" />
                    <div *ngIf="satFatInput.invalid && satFatInput.touched" class="error">
                      Saturated fat must be a positive number.
                    </div>
                  </div>
                  <div class="form-group">
                    <label>Fiber:</label>
                    <input type="number" [(ngModel)]="newIngredient.fiber" name="fiber" #fiberInput="ngModel" required min="0" />
                    <div *ngIf="fiberInput.invalid && fiberInput.touched" class="error">
                      Fiber must be a positive number.
                    </div>
                  </div>
                  <div class="form-group">
                    <label>Category:</label>
                    <select [(ngModel)]="newIngredient.category" name="category" required>
                      <option *ngFor="let category of categories" [value]="category">{{ category }}</option>
                    </select>
                  </div>
                  <div class="form-actions">
                    <button type="submit" class="add-btn" [disabled]="foodInput.invalid || gramsInput.invalid || caloriesInput.invalid">Add</button>
                  </div>
                </form>
              </div>
            </div>
            
                  
              </div>
              
            </div>
            

